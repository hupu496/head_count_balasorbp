{% extends 'layouts/base_background.html' %}
{% load static %}
{% block css %}
.mt-n6 {
margin-top: 0rem !important;
}
.text-gradient.text-primary {
background-image: linear-gradient(195deg, #021750, #021750);
}
.btn-primary {
--bs-btn-color: #000;
--bs-btn-bg: #f37022;
--bs-btn-border-color: #f37022;
}
.Cd{
border-style: solid;
border-color: #3e4f7a;
border-radius: 9px;
}
marquee {
width: 100%;
height: 100%;
display: block;
}
/* Add this for watermark background */
.watermark-background {
    background-image: url("{% static 'img/IndianOil_background.jpg' %}");
    background-size: cover; /* Ensures the image covers the entire container */
    background-position: center;
    background-repeat: no-repeat;
    opacity: 0.2; /* Controls the opacity of the watermark */
    position: fixed; /* Keeps the background fixed during scrolling */
    top: 0;
    left: 0;
    width: 100vw; /* Full viewport width */
    height: 100vh; /* Full viewport height */
    z-index: -1; /* Sends the image behind other content */
}
.linear-text-gradient {
                background: linear-gradient(to top, #eb6c21, #02154d);
                -webkit-background-clip: text;
                background-clip: text;
                color: transparent;
            }


{% endblock css %}
{% block title %} IOCL | Head Count System {% endblock title %}
{% block body %} class="index-page bg-gray-200" {% endblock body %}
{% block content %}
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
   // Only run the interval if the form is not valid
   {% if not form_valid %}
   var ajaxInterval = setInterval(function() {
     $.ajax({
         url: "{% url 'live_data' %}",  // URL of the Django view (home)
         type: 'GET',
         success: function(data) {
             // Assuming the Django view returns JSON data or HTML content to update specific sections
             
             // Parse the returned data and update the page content
             $('#hazard-in').text(data.hazard_in_count);  // Update hazard in count
             $('#hazard-out').text(data.hazard_out_count);  // Update hazard out count
             $('#hazard-total').text(data.hazard_total);  // Update hazard total

             $('#non-hazard-in').text(data.non_hazard_in);  // Update non-hazard in count
             $('#non-hazard-out').text(data.non_hazard_out);  // Update non-hazard out count
             $('#non-hazard-total').text(data.non_hazard_total);  // Update non-hazard total

           
         },
         error: function(xhr, status, error) {
             console.error('Error occurred:', error);
         }
     });
   }, 5000);  // Makes an AJAX call every 5 seconds
   {% else %}
   // If form is valid, clear the interval to stop AJAX updates
   clearInterval(ajaxInterval);
   {% endif %}
</script>
</div></div></div>
{% load static %}
<div class="watermark-background"></div>
<div class=" mx-3 mx-md-4 mt-n6">
   <b class="text-center text-success" style="font-size: 24px">
      <img src="{% static 'img/indianOil.png' %}" width="20%">GATE WISE HEAD COUNT DISPLAY BALASORE BP AS ON&nbsp; &nbsp; 
      <form method="post" style="display:inline;">
         {% csrf_token %}
         {{ form.selected_date }}
         <button type="submit" class="btn btn-sm bg-gradient-success" style="margin-top: 10px;" >Refresh</button>
      </form>
   </b>
   <div class="container-fluid">
      <div class="row">
         <div class="col-md-9 col-12">
             <section class="Cd pt-3 pb-4" id="count-stats">
      <div class="container-fluid">
         <div class="row">
            <div class="col-lg-12 mx-auto py-4">
               <div style="border: 5px solid transparent;border-image: linear-gradient(#01154d, #eb6c21) 1; border-radius: 21px; padding: 10px; position: relative;">
                  <h2 style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); background-color: white; padding: 0 10px; color: #4caf50;">NON HAZARDOUS AREA</h2>
                  <div class="row">
                     <div class="col-md-3 position-relative">
                        <div class="p-2 text-center">
                           <h1 class="text-gradient text-primary"><img src="{% static 'img/head.png' %}"></h1>
                          
                           <div >
                              
                              <h4 class="text-gradient text-primary"></i>MAIN GATE</h4>
                           </div>
                        </div>
                        <hr class="vertical dark">
                     </div>
                     <div class="col-md-3 position-relative">
                        <div class="p-3 text-center">
                           <h1 class="text-gradient text-primary"><i class="fas fa-users"></i></h1>
                           <h5 class="mt-3">TOTAL HEAD COUNT</h5>
                           <a href="list/MAIN GATE TOTAL HEAD COUNT" target="_blank" class="btn btn-icon btn-2 bg-gradient-success"style="width: 145px;">
                           <b style="font-size: 20px;" id="non-hazard-total">{{ non_hazard_total }}</b>
                           </a>
                        </div>
                        <hr class="vertical dark">
                     </div>
                     <div class="col-md-3 position-relative">
                        <div class="p-3 text-center">
                           <h1 class="text-gradient text-primary"><i class="far fa-arrow-alt-circle-right"></i></h1>
                           <h5 class="mt-3">IN</h5>
                           <a href="list/MAIN GATE IN" target="_blank" class="btn btn-icon btn-2 bg-gradient-success"style="width: 145px;">
                           <b style="font-size: 20px;" id="non-hazard-in">{{ non_hazard_in }}</b>
                           </a>
                        </div>
                        <hr class="vertical dark">
                     </div>
                     <div class="col-md-3">
                        <div class="p-3 text-center">
                           <h1 class="text-gradient text-primary"><i class="far fa-arrow-alt-circle-left"></i></h1>
                           <h5 class="mt-3">OUT</h5>
                           <a href="list/MAIN GATE OUT" target="_blank" class="btn btn-icon btn-2 bg-gradient-success"style="width: 145px;">
                           <b style="font-size: 20px;" id="non-hazard-out">{{ non_hazard_out }}</b>
                           </a>
                        </div>
                     </div>
                  </div>
               </div>
               <!--  -->
               <br>
               <div style="border: 5px solid transparent;border-image: linear-gradient(#01154d, #eb6c21) 1; border-radius: 21px; padding: 10px; position: relative;">
                  <h2 style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); background-color: white; padding: 0 10px; color: #f44335;">HAZARDOUS AREA</h2>
                  <div class="row">
                     <div class="col-md-3 position-relative">
                        <div class="p-3 text-center">
                           <div >
                              <h4 class="text-gradient text-primary"></i>GATE3</h4>
                           </div>
                        </div>
                        <hr class="vertical dark">
                     </div>
                     <div class="col-md-3 position-relative">
                        <div class="p-3 text-center">
                           <h1 class="text-gradient text-primary"></h1>
                           <!--   <h5 class="mt-3">TOTAL HEAD COUNT</h5> -->
                           <a href="list/GATE3 TOTAL HEAD COUNT" target="_blank" class="btn btn-icon btn-2 btn btn-danger" style="width: 145px;">
                           <b style="font-size: 20px;" id="hazard-total">{{ hazard_total }}</b>
                           </a>
                        </div>
                        <hr class="vertical dark">
                     </div>
                     <div class="col-md-3 position-relative">
                        <div class="p-3 text-center">
                           <h1 class="text-gradient text-primary"></h1>
                           <!--   <h5 class="mt-3">IN</h5> -->
                           <a href="list/GATE3 IN" target="_blank" class="btn btn-icon btn-2 btn btn-danger"style="width: 145px;" >
                           <b style="font-size: 20px;" id="hazard-in">{{ hazard_in_count }}</b>
                           </a>
                        </div>
                        <hr class="vertical dark">
                     </div>
                     <div class="col-md-3">
                        <div class="p-3 text-center">
                           <h1 class="text-gradient text-primary" ></h1>
                           <!-- <h5 class="mt-3">OUT</h5> -->
                           <a href="list/GATE3 OUT" target="_blank" class="btn btn-icon btn-2 btn btn-danger"style="width: 145px;" >
                           <b style="font-size: 20px;" id="hazard-out">{{ hazard_out_count }}</b>
                           </a>
                        </div>
                     </div>
                     <!--  -->
                   
                     
                  </div>
               </div>
               <!--  -->
            </div>
         </div>
      </div>

</section>
         </div>
         <div class="col-md-3 col-12">
             <img src="{% static 'img/notification.png' %}" width="30%" style="margin-top:-105px; margin-left: 100px; text-align: center;">
          
       
        
               <div style="
               height: 470px;
               ">
                <!-- <span class="linear-text-gradient" style="font-size:25px; font-weight: 500; ">EmpCode&nbsp;&nbsp;Gate</span> -->
                 
                     {% for item in data %}
                     {% if item.machine.machineno == '1' or item.machine.machineno == '5' %}
                     <h6 style="background-color:#4CAF50; color: white; padding: 5px; border-radius: 5px;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">{{ item.employee.empcode }}&nbsp;{{ item.employee.Name }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ item.machine.Name }} {{ item.machine.Response }}  </h6>
                      {% elif item.machine.machineno == '2' or item.machine.machineno == '6' %}
                     <h6 style="background-color:#4CAF50; color: white; padding: 5px; border-radius: 5px;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">{{ item.employee.empcode }}&nbsp;{{ item.employee.Name }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ item.machine.Name }} {{ item.machine.Response }}  </h6>
                     {% elif item.machine.machineno == '3' or item.machine.machineno == '7' %}
                     <h6 style="background-color: #F44335;color: white; padding: 5px; border-radius: 5px;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">{{ item.employee.empcode }}&nbsp;{{ item.employee.Name }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ item.machine.Name }}{{ item.machine.Response }}  </h6>
                      {% elif item.machine.machineno == '4' or item.machine.machineno == '8' %}
                     <h6 style="background-color: #F44335;color: white; padding: 5px; border-radius: 5px;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">{{ item.employee.empcode }}&nbsp;{{ item.employee.Name }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ item.machine.Name }}{{ item.machine.Response }}  </h6>
                     {% endif %}
                     {% endfor %}
                 
               </div>
            
      </div>
   </div>
  

</div>
<!-- <p>{{ context }}</p> -->
{% endblock content %}
{% block javascripts %}
<!--  Plugin for TypedJS, full documentation here: https://github.com/inorganik/CountUp.js -->
<script src="{% static 'js/plugins/countup.min.js' %}"></script>
<script src="{% static 'js/plugins/choices.min.js' %}"></script>
<script src="{% static 'js/plugins/prism.min.js' %}"></script>
<script src="{% static 'js/plugins/highlight.min.js' %}"></script>
<!--  Plugin for Parallax, full documentation here: https://github.com/dixonandmoe/rellax -->
<script src="{% static 'js/plugins/rellax.min.js' %}"></script>
<!--  Plugin for TiltJS, full documentation here: https://gijsroge.github.io/tilt.js/ -->
<script src="{% static 'js/plugins/tilt.min.js' %}"></script>
<!--  Plugin for Selectpicker - ChoicesJS, full documentation here: https://github.com/jshjohnson/Choices -->
<script src="{% static 'js/plugins/choices.min.js' %}"></script>
<!-- <script>
   setTimeout(function(){
       location.reload();
   }, 10000);  // 10000 milliseconds = 10 seconds
   </script> -->
<script type="text/javascript">
   if (document.getElementById('state1')) {
     const countUp = new CountUp('state1', document.getElementById("state1").getAttribute("countTo"));
     if (!countUp.error) {
       countUp.start();
     } else {
       console.error(countUp.error);
     }
   }
   if (document.getElementById('state2')) {
     const countUp1 = new CountUp('state2', document.getElementById("state2").getAttribute("countTo"));
     if (!countUp1.error) {
       countUp1.start();
     } else {
       console.error(countUp1.error);
     }
   }
   if (document.getElementById('state3')) {
     const countUp2 = new CountUp('state3', document.getElementById("state3").getAttribute("countTo"));
     if (!countUp2.error) {
       countUp2.start();
     } else {
       console.error(countUp2.error);
     };
   }
</script>
<script type="text/javascript">
   setInterval(function() {
     $.ajax({
         url: "{% url 'home' %}",
         success: function(data) {
             // Update the page content without refreshing
         }
     });
   }, 2000);  // Makes an AJAX call every 5 seconds
   
</script>
{% endblock javascripts %}